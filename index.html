<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>‡πÑ‡∏û‡πà‡∏™‡∏•‡∏≤‡∏ü (Slaf / War) ‚Äî ‡πÄ‡∏•‡πà‡∏ô‡∏Å‡∏±‡∏ö‡∏ö‡∏≠‡∏ó</title>
  <style>
    :root{
      --bg1:#0b1020;
      --bg2:#0c2a2d;
      --card:#111a2f;
      --card2:#0f1730;
      --glass: rgba(255,255,255,.08);
      --glass2: rgba(255,255,255,.12);
      --txt: rgba(255,255,255,.92);
      --muted: rgba(255,255,255,.68);
      --good:#2ce39b;
      --bad:#ff4d6d;
      --warn:#ffcc66;
      --shadow: 0 20px 60px rgba(0,0,0,.45);
      --radius: 22px;
    }
    *{ box-sizing:border-box; }
    html,body{ height:100%; }
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Noto Sans Thai", "Noto Sans", Arial, sans-serif;
      color:var(--txt);
      background:
        radial-gradient(1200px 800px at 10% 10%, rgba(76, 201, 240,.22), transparent 60%),
        radial-gradient(900px 700px at 90% 20%, rgba(247, 37, 133,.18), transparent 55%),
        radial-gradient(900px 700px at 70% 90%, rgba(46, 227, 155,.18), transparent 55%),
        linear-gradient(135deg, var(--bg1), var(--bg2));
      overflow-x:hidden;
    }
    .wrap{
      min-height:100%;
      display:flex;
      align-items:stretch;
      justify-content:center;
      padding:24px;
    }
    .app{
      width:min(1100px, 100%);
      display:grid;
      grid-template-columns: 1.2fr .8fr;
      gap:18px;
      align-items:stretch;
    }
    @media (max-width: 980px){
      .app{ grid-template-columns: 1fr; }
    }

    .panel{
      background: linear-gradient(180deg, rgba(255,255,255,.10), rgba(255,255,255,.06));
      border: 1px solid rgba(255,255,255,.10);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      backdrop-filter: blur(12px);
      overflow:hidden;
      position:relative;
    }
    .panel::before{
      content:"";
      position:absolute; inset:-2px;
      background: radial-gradient(500px 200px at 30% 0%, rgba(255,255,255,.16), transparent 70%);
      pointer-events:none;
    }
    header{
      display:flex;
      justify-content:space-between;
      align-items:flex-start;
      padding:18px 18px 10px;
      position:relative;
      z-index:1;
    }
    .title{
      display:flex; gap:12px; align-items:center;
    }
    .logo{
      width:42px; height:42px; border-radius:14px;
      background: linear-gradient(135deg, rgba(76,201,240,.35), rgba(247,37,133,.25));
      border:1px solid rgba(255,255,255,.14);
      display:grid; place-items:center;
      box-shadow: 0 12px 24px rgba(0,0,0,.25);
    }
    .logo svg{ opacity:.95; }
    h1{
      font-size:18px;
      margin:0;
      letter-spacing:.2px;
    }
    .sub{
      margin-top:4px;
      font-size:12.5px;
      color:var(--muted);
      line-height:1.35;
    }
    .pill{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding:10px 12px;
      border-radius: 999px;
      background: rgba(0,0,0,.18);
      border: 1px solid rgba(255,255,255,.10);
      color: var(--muted);
      font-size:12px;
      user-select:none;
    }
    .pill b{ color:var(--txt); font-weight:700; }
    .content{
      padding: 8px 18px 18px;
      position:relative;
      z-index:1;
    }

    /* Table */
    .table{
      display:grid;
      grid-template-rows: auto 1fr auto;
      gap:14px;
      min-height: 520px;
      padding-bottom: 6px;
    }
    .arena{
      border-radius: 18px;
      border: 1px solid rgba(255,255,255,.12);
      background: linear-gradient(180deg, rgba(0,0,0,.22), rgba(0,0,0,.12));
      padding: 16px;
      position:relative;
      overflow:hidden;
    }
    .arena::after{
      content:"";
      position:absolute;
      inset:0;
      background:
        radial-gradient(600px 220px at 50% 0%, rgba(46,227,155,.12), transparent 60%),
        radial-gradient(600px 220px at 50% 100%, rgba(76,201,240,.12), transparent 60%);
      pointer-events:none;
    }

    .rows{
      position:relative;
      z-index:1;
      display:grid;
      grid-template-rows: 1fr auto 1fr;
      gap: 14px;
      height:100%;
      min-height: 360px;
    }
    .playerRow{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:14px;
    }
    .name{
      display:flex;
      flex-direction:column;
      gap:4px;
      min-width: 180px;
    }
    .name .who{
      display:flex;
      align-items:center;
      gap:10px;
      font-weight:800;
      letter-spacing:.2px;
    }
    .badge{
      font-size:11px;
      padding:4px 9px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.06);
      color: var(--muted);
    }
    .counts{
      display:flex;
      gap:8px;
      flex-wrap:wrap;
      color: var(--muted);
      font-size:12px;
    }
    .counts span{
      padding:6px 10px;
      border-radius:999px;
      background: rgba(0,0,0,.18);
      border: 1px solid rgba(255,255,255,.10);
    }

    .centerRow{
      display:flex;
      align-items:center;
      justify-content:center;
      gap:14px;
      position:relative;
      padding:4px 0;
    }
    .potInfo{
      display:flex;
      align-items:center;
      gap:10px;
      padding:10px 12px;
      border-radius: 14px;
      border:1px dashed rgba(255,255,255,.22);
      background: rgba(0,0,0,.18);
      color: var(--muted);
      font-size:12px;
      user-select:none;
    }
    .potInfo b{ color:var(--txt); }
    .divider{
      height:1px; width: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,.14), transparent);
      margin: 8px 0 2px;
    }

    /* Cards */
    .slot{
      display:flex;
      align-items:center;
      justify-content:flex-end;
      gap:12px;
      width: 100%;
    }
    .slot.bot { justify-content:flex-end; }
    .slot.you { justify-content:flex-end; }

    .card{
      width: 120px;
      height: 168px;
      border-radius: 18px;
      background: linear-gradient(180deg, rgba(255,255,255,.12), rgba(255,255,255,.06));
      border: 1px solid rgba(255,255,255,.14);
      box-shadow: 0 18px 40px rgba(0,0,0,.35);
      position:relative;
      overflow:hidden;
      transform: translateZ(0);
      user-select:none;
    }
    .card::before{
      content:"";
      position:absolute; inset:-2px;
      background:
        radial-gradient(220px 160px at 20% 10%, rgba(76,201,240,.18), transparent 70%),
        radial-gradient(220px 160px at 80% 90%, rgba(247,37,133,.16), transparent 70%);
      pointer-events:none;
    }
    .cardInner{
      position:absolute; inset:10px;
      border-radius: 14px;
      background: linear-gradient(180deg, rgba(0,0,0,.20), rgba(0,0,0,.08));
      border: 1px solid rgba(255,255,255,.10);
      padding:12px;
      display:flex;
      flex-direction:column;
      justify-content:space-between;
      gap:10px;
    }
    .corner{
      display:flex;
      flex-direction:column;
      align-items:flex-start;
      gap:2px;
      font-weight:900;
      letter-spacing:.3px;
    }
    .corner.bottom{
      align-items:flex-end;
      transform: rotate(180deg);
    }
    .rank{ font-size:18px; line-height:1; }
    .suit{ font-size:14px; opacity:.9; }
    .big{
      display:grid;
      place-items:center;
      font-size:44px;
      filter: drop-shadow(0 8px 12px rgba(0,0,0,.28));
    }
    .red{ color: #ff5a7a; }
    .blk{ color: rgba(255,255,255,.92); }

    .back{
      background: linear-gradient(135deg, rgba(0,0,0,.22), rgba(0,0,0,.10));
    }
    .back .cardInner{
      background: linear-gradient(135deg, rgba(76,201,240,.12), rgba(247,37,133,.10));
      border-style: dashed;
    }
    .pattern{
      height:100%;
      border-radius: 12px;
      background:
        radial-gradient(circle at 20% 20%, rgba(255,255,255,.22) 0 2px, transparent 2px 100%),
        radial-gradient(circle at 80% 30%, rgba(255,255,255,.18) 0 2px, transparent 2px 100%),
        radial-gradient(circle at 40% 75%, rgba(255,255,255,.16) 0 2px, transparent 2px 100%),
        linear-gradient(135deg, rgba(255,255,255,.06), rgba(255,255,255,.02));
      background-size: 32px 32px, 34px 34px, 36px 36px, auto;
      position:relative;
      overflow:hidden;
    }
    .pattern::after{
      content:"";
      position:absolute; inset:-40px;
      background: conic-gradient(from 120deg, rgba(255,255,255,.06), transparent, rgba(255,255,255,.06));
      animation: spin 8s linear infinite;
      opacity:.8;
    }
    @keyframes spin{ to{ transform: rotate(360deg);} }

    /* Animations */
    .pop{
      animation: pop .22s ease-out;
    }
    @keyframes pop{
      from{ transform: translateY(10px) scale(.98); opacity:.0; }
      to{ transform: translateY(0) scale(1); opacity:1; }
    }
    .shake{
      animation: shake .35s ease-in-out;
    }
    @keyframes shake{
      0%,100%{ transform: translateX(0); }
      25%{ transform: translateX(-6px); }
      75%{ transform: translateX(6px); }
    }
    .glowWin{
      box-shadow: 0 0 0 2px rgba(46,227,155,.25), 0 22px 55px rgba(46,227,155,.18);
    }
    .glowLose{
      box-shadow: 0 0 0 2px rgba(255,77,109,.22), 0 22px 55px rgba(255,77,109,.14);
    }

    /* Controls */
    .controls{
      display:flex;
      flex-wrap:wrap;
      gap:10px;
      align-items:center;
      justify-content:space-between;
    }
    .btnRow{ display:flex; flex-wrap:wrap; gap:10px; }
    button{
      appearance:none;
      border:none;
      cursor:pointer;
      color: var(--txt);
      padding: 11px 12px;
      border-radius: 14px;
      background: rgba(255,255,255,.10);
      border: 1px solid rgba(255,255,255,.14);
      box-shadow: 0 14px 28px rgba(0,0,0,.22);
      font-weight:800;
      letter-spacing:.15px;
      transition: transform .08s ease, filter .12s ease, background .12s ease;
      user-select:none;
    }
    button:hover{ filter: brightness(1.05); }
    button:active{ transform: translateY(1px) scale(.99); }
    button:disabled{
      opacity:.45;
      cursor:not-allowed;
      filter:saturate(.7);
    }
    .primary{
      background: linear-gradient(135deg, rgba(46,227,155,.22), rgba(76,201,240,.16));
      border-color: rgba(46,227,155,.22);
    }
    .danger{
      background: linear-gradient(135deg, rgba(255,77,109,.22), rgba(247,37,133,.14));
      border-color: rgba(255,77,109,.22);
    }
    .ghost{
      background: rgba(0,0,0,.14);
    }
    .toggle{
      display:flex;
      gap:10px;
      align-items:center;
      color: var(--muted);
      font-size:12px;
      user-select:none;
    }
    .toggle input{ accent-color: #2ce39b; }
    .speed{
      display:flex;
      gap:10px;
      align-items:center;
      color: var(--muted);
      font-size:12px;
    }
    .speed input[type="range"]{ width:140px; }

    /* Side panel */
    .side{
      padding: 16px 16px 18px;
      position:relative;
      z-index:1;
      display:flex;
      flex-direction:column;
      gap:12px;
      height:100%;
    }
    .box{
      border-radius: 18px;
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(0,0,0,.18);
      padding: 14px;
    }
    .box h2{
      margin:0 0 8px;
      font-size:14px;
      letter-spacing:.2px;
    }
    .log{
      height: 320px;
      overflow:auto;
      padding-right: 6px;
      scroll-behavior:smooth;
    }
    .entry{
      display:flex;
      gap:10px;
      align-items:flex-start;
      margin: 10px 0;
      color: var(--muted);
      font-size: 12.5px;
      line-height:1.35;
    }
    .dot{
      margin-top:4px;
      width:10px; height:10px;
      border-radius:999px;
      background: rgba(255,255,255,.16);
      border: 1px solid rgba(255,255,255,.14);
      flex:0 0 auto;
    }
    .entry.win .dot{ background: rgba(46,227,155,.35); border-color: rgba(46,227,155,.35); }
    .entry.lose .dot{ background: rgba(255,77,109,.35); border-color: rgba(255,77,109,.35); }
    .entry.warn .dot{ background: rgba(255,204,102,.35); border-color: rgba(255,204,102,.35); }
    .miniStats{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:10px;
    }
    .stat{
      border-radius: 16px;
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.06);
      padding: 12px;
    }
    .stat .k{
      color: var(--muted);
      font-size:11.5px;
    }
    .stat .v{
      margin-top:6px;
      font-size:18px;
      font-weight:900;
      letter-spacing:.2px;
    }
    .footerHint{
      color: rgba(255,255,255,.55);
      font-size:11.5px;
      line-height:1.35;
    }

    /* Toast */
    .toast{
      position: fixed;
      left: 50%;
      bottom: 18px;
      transform: translateX(-50%);
      background: rgba(0,0,0,.55);
      border: 1px solid rgba(255,255,255,.12);
      color: var(--txt);
      padding: 10px 12px;
      border-radius: 999px;
      backdrop-filter: blur(10px);
      box-shadow: 0 16px 40px rgba(0,0,0,.35);
      opacity:0;
      pointer-events:none;
      transition: opacity .18s ease, transform .18s ease;
      font-size:12.5px;
      z-index:99;
    }
    .toast.show{
      opacity:1;
      transform: translateX(-50%) translateY(-4px);
    }
    .kbd{
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      font-size: 11px;
      padding:2px 6px;
      border-radius: 8px;
      background: rgba(255,255,255,.10);
      border: 1px solid rgba(255,255,255,.12);
      color: rgba(255,255,255,.8);
      margin-left:6px;
    }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="app">
      <section class="panel">
        <header>
          <div class="title">
            <div class="logo" aria-hidden="true">
              <svg width="22" height="22" viewBox="0 0 24 24" fill="none">
                <path d="M12 2l7 4v6c0 5-3.5 9-7 10-3.5-1-7-5-7-10V6l7-4z" stroke="rgba(255,255,255,.85)" stroke-width="1.6"/>
                <path d="M8 12h8" stroke="rgba(255,255,255,.75)" stroke-width="1.6" stroke-linecap="round"/>
              </svg>
            </div>
            <div>
              <h1>‡πÑ‡∏û‡πà‡∏™‡∏•‡∏≤‡∏ü (Slaf / War)</h1>
              <div class="sub">‡πÄ‡∏õ‡∏¥‡∏î‡πÑ‡∏û‡πà‡πÅ‡∏Ç‡πà‡∏á‡∏Å‡∏±‡∏ö‡∏ö‡∏≠‡∏ó ‚Ä¢ ‡πÄ‡∏™‡∏°‡∏≠ = ‚Äú‡∏™‡∏•‡∏≤‡∏ü‚Äù (‡∏Ñ‡∏ß‡πà‡∏≥ 3 ‡πÉ‡∏ö + ‡πÄ‡∏õ‡∏¥‡∏î 1 ‡πÉ‡∏ö) ‚Ä¢ ‡πÉ‡∏Ñ‡∏£‡∏´‡∏°‡∏î‡πÑ‡∏û‡πà‡πÅ‡∏û‡πâ</div>
            </div>
          </div>
          <div class="pill" id="statusPill"><b>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞:</b> ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÄ‡∏£‡∏¥‡πà‡∏°</div>
        </header>

        <div class="content">
          <div class="table">
            <div class="arena">
              <div class="rows">
                <!-- BOT -->
                <div class="playerRow">
                  <div class="name">
                    <div class="who">ü§ñ BOT <span class="badge" id="botMood">‡∏ô‡∏¥‡πà‡∏á‡πÜ</span></div>
                    <div class="counts">
                      <span>‡πÑ‡∏û‡πà‡πÉ‡∏ô‡∏Å‡∏≠‡∏á: <b id="botCount">26</b></span>
                      <span>‡πÅ‡∏ï‡πâ‡∏°‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î: <b id="botVal">-</b></span>
                    </div>
                  </div>
                  <div class="slot bot">
                    <div class="card back" id="botCardBack" title="‡πÑ‡∏û‡πà‡∏Ç‡∏≠‡∏á‡∏ö‡∏≠‡∏ó">
                      <div class="cardInner">
                        <div class="pattern"></div>
                      </div>
                    </div>
                    <div class="card" id="botCard" style="display:none;">
                      <div class="cardInner">
                        <div class="corner top"><div class="rank" id="botRank">A</div><div class="suit" id="botSuit">‚ô†</div></div>
                        <div class="big" id="botBig">‚ô†</div>
                        <div class="corner bottom"><div class="rank" id="botRank2">A</div><div class="suit" id="botSuit2">‚ô†</div></div>
                      </div>
                    </div>
                  </div>
                </div>

                <!-- CENTER -->
                <div class="centerRow">
                  <div class="potInfo">‡∏Å‡∏≠‡∏á‡∏Å‡∏•‡∏≤‡∏á (Pot): <b id="potCount">0</b> ‡πÉ‡∏ö ‚Ä¢ ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏™‡∏•‡∏≤‡∏ü: <b id="warState">‡∏õ‡∏Å‡∏ï‡∏¥</b></div>
                </div>

                <!-- YOU -->
                <div class="playerRow">
                  <div class="name">
                    <div class="who">üßë‚Äçüíª YOU <span class="badge" id="youMood">‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏•‡∏∏‡∏¢</span></div>
                    <div class="counts">
                      <span>‡πÑ‡∏û‡πà‡πÉ‡∏ô‡∏Å‡∏≠‡∏á: <b id="youCount">26</b></span>
                      <span>‡πÅ‡∏ï‡πâ‡∏°‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î: <b id="youVal">-</b></span>
                    </div>
                  </div>
                  <div class="slot you">
                    <div class="card back" id="youCardBack" title="‡πÑ‡∏û‡πà‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì">
                      <div class="cardInner">
                        <div class="pattern"></div>
                      </div>
                    </div>
                    <div class="card" id="youCard" style="display:none;">
                      <div class="cardInner">
                        <div class="corner top"><div class="rank" id="youRank">A</div><div class="suit" id="youSuit">‚ô†</div></div>
                        <div class="big" id="youBig">‚ô†</div>
                        <div class="corner bottom"><div class="rank" id="youRank2">A</div><div class="suit" id="youSuit2">‚ô†</div></div>
                      </div>
                    </div>
                  </div>
                </div>

              </div>
            </div>

            <div class="divider"></div>

            <div class="controls">
              <div class="btnRow">
                <button class="primary" id="btnNew">‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏Å‡∏°‡πÉ‡∏´‡∏°‡πà</button>
                <button class="ghost" id="btnDeal" disabled>‡πÅ‡∏à‡∏Å & ‡∏™‡∏±‡∏ö</button>
                <button class="primary" id="btnFlip" disabled>‡∏ß‡∏≤‡∏á‡πÑ‡∏û‡πà (Space)</button>
                <button class="danger" id="btnAuto" disabled>‡πÄ‡∏•‡πà‡∏ô‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥</button>
              </div>

              <div style="display:flex; gap:14px; align-items:center; flex-wrap:wrap; justify-content:flex-end;">
                <label class="toggle">
                  <input type="checkbox" id="chkFast" />
                  ‡πÇ‡∏´‡∏°‡∏î‡πÄ‡∏£‡πá‡∏ß (‡∏≠‡∏ô‡∏¥‡πÄ‡∏°‡∏ä‡∏±‡∏ô‡∏™‡∏±‡πâ‡∏ô)
                </label>
                <div class="speed">
                  ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß‡∏≠‡∏≠‡πÇ‡∏ï‡πâ
                  <input type="range" id="rngSpeed" min="150" max="1200" value="520" />
                  <span id="speedLabel">520ms</span>
                </div>
              </div>
            </div>

          </div>
        </div>
      </section>

      <aside class="panel">
        <div class="side">
          <div class="box">
            <h2>‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥</h2>
            <div class="miniStats">
              <div class="stat">
                <div class="k">‡∏£‡∏≠‡∏ö‡∏ó‡∏µ‡πà‡πÄ‡∏•‡πà‡∏ô</div>
                <div class="v" id="rounds">0</div>
              </div>
              <div class="stat">
                <div class="k">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏™‡∏•‡∏≤‡∏ü</div>
                <div class="v" id="wars">0</div>
              </div>
              <div class="stat">
                <div class="k">‡∏ä‡∏ô‡∏∞‡∏£‡∏≠‡∏ö (YOU)</div>
                <div class="v" id="youWins">0</div>
              </div>
              <div class="stat">
                <div class="k">‡∏ä‡∏ô‡∏∞‡∏£‡∏≠‡∏ö (BOT)</div>
                <div class="v" id="botWins">0</div>
              </div>
            </div>
            <div style="height:10px"></div>
            <div class="footerHint">
              ‡∏Ñ‡∏µ‡∏¢‡πå‡∏•‡∏±‡∏î: <span class="kbd">Space</span> ‡∏ß‡∏≤‡∏á‡πÑ‡∏û‡πà ‚Ä¢ <span class="kbd">A</span> ‡πÄ‡∏•‡πà‡∏ô‡∏≠‡∏≠‡πÇ‡∏ï‡πâ ‚Ä¢ <span class="kbd">R</span> ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÉ‡∏´‡∏°‡πà
            </div>
          </div>

          <div class="box">
            <h2>‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏Å‡∏°</h2>
            <div class="log" id="log"></div>
          </div>

          <div class="box">
            <h2>‡∏Å‡∏ï‡∏¥‡∏Å‡∏≤‡∏™‡∏±‡πâ‡∏ô‡πÜ</h2>
            <div class="footerHint">
              ‡πÄ‡∏õ‡∏¥‡∏î‡πÑ‡∏û‡πà‡∏ö‡∏ô‡∏™‡∏∏‡∏î‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Å‡∏±‡∏ô ‚Ä¢ ‡∏™‡∏π‡∏á‡∏Å‡∏ß‡πà‡∏≤‡∏ä‡∏ô‡∏∞‡πÅ‡∏•‡∏∞‡πÄ‡∏≠‡∏≤‡πÑ‡∏û‡πà‡πÉ‡∏ô‡∏Å‡∏≠‡∏á‡∏Å‡∏•‡∏≤‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÑ‡∏õ‡πÑ‡∏ß‡πâ‡∏ó‡πâ‡∏≤‡∏¢‡∏Å‡∏≠‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á<br/>
              ‡∏ñ‡πâ‡∏≤‡πÄ‡∏™‡∏°‡∏≠: ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏•‡∏≤‡∏ü ‚Üí ‡∏Ñ‡∏ß‡πà‡∏≥ 3 ‡πÉ‡∏ö + ‡πÄ‡∏õ‡∏¥‡∏î 1 ‡πÉ‡∏ö ‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡πÉ‡∏´‡∏°‡πà (‡∏ñ‡πâ‡∏≤‡πÑ‡∏û‡πà‡πÑ‡∏°‡πà‡∏û‡∏≠‡∏à‡∏∞‡∏Ñ‡∏ß‡πà‡∏≥/‡πÄ‡∏õ‡∏¥‡∏î ‡πÉ‡∏´‡πâ‡∏•‡∏á‡πÄ‡∏ó‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏°‡∏µ)
            </div>
          </div>
        </div>
      </aside>
    </div>
  </div>

  <div class="toast" id="toast">‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÄ‡∏•‡πà‡∏ô!</div>

<script>
(() => {
  // ----- Utilities -----
  const $ = (id) => document.getElementById(id);
  const sleep = (ms) => new Promise(res => setTimeout(res, ms));
  const clamp = (n, a, b) => Math.max(a, Math.min(b, n));

  const SUITS = [
    { s: "‚ô†", color: "blk" },
    { s: "‚ô•", color: "red" },
    { s: "‚ô¶", color: "red" },
    { s: "‚ô£", color: "blk" },
  ];
  const RANKS = [
    { r:"2", v:2 }, { r:"3", v:3 }, { r:"4", v:4 }, { r:"5", v:5 },
    { r:"6", v:6 }, { r:"7", v:7 }, { r:"8", v:8 }, { r:"9", v:9 },
    { r:"10", v:10 }, { r:"J", v:11 }, { r:"Q", v:12 }, { r:"K", v:13 }, { r:"A", v:14 },
  ];

  function makeDeck(){
    const deck = [];
    for (const suit of SUITS){
      for (const rk of RANKS){
        deck.push({ rank: rk.r, value: rk.v, suit: suit.s, color: suit.color });
      }
    }
    return deck;
  }
  function shuffle(a){
    for (let i=a.length-1; i>0; i--){
      const j = Math.floor(Math.random()*(i+1));
      [a[i], a[j]] = [a[j], a[i]];
    }
    return a;
  }
  function formatCard(c){ return `${c.rank}${c.suit}`; }

  // ----- UI -----
  const statusPill = $("statusPill");
  const botMood = $("botMood"), youMood = $("youMood");
  const botCount = $("botCount"), youCount = $("youCount");
  const potCount = $("potCount"), warState = $("warState");
  const botVal = $("botVal"), youVal = $("youVal");

  const botCard = $("botCard"), youCard = $("youCard");
  const botCardBack = $("botCardBack"), youCardBack = $("youCardBack");

  const btnNew = $("btnNew"), btnDeal = $("btnDeal"), btnFlip = $("btnFlip"), btnAuto = $("btnAuto");
  const chkFast = $("chkFast"), rngSpeed = $("rngSpeed"), speedLabel = $("speedLabel");
  const logEl = $("log");
  const toast = $("toast");

  const roundsEl = $("rounds"), warsEl = $("wars"), youWinsEl = $("youWins"), botWinsEl = $("botWins");

  function setStatus(text){
    statusPill.innerHTML = `<b>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞:</b> ${text}`;
  }
  function addLog(text, type=""){
    const div = document.createElement("div");
    div.className = `entry ${type}`.trim();
    div.innerHTML = `<span class="dot"></span><div>${text}</div>`;
    logEl.appendChild(div);
    logEl.scrollTop = logEl.scrollHeight;
  }
  let toastTimer = null;
  function showToast(msg){
    toast.textContent = msg;
    toast.classList.add("show");
    clearTimeout(toastTimer);
    toastTimer = setTimeout(()=> toast.classList.remove("show"), 1400);
  }

  function renderCard(who, cardObj){
    const isBot = who === "bot";
    const card = isBot ? botCard : youCard;
    const back = isBot ? botCardBack : youCardBack;

    if (!cardObj){
      card.style.display = "none";
      back.style.display = "block";
      return;
    }

    back.style.display = "none";
    card.style.display = "block";
    card.classList.remove("pop","shake","glowWin","glowLose");
    void card.offsetWidth;
    card.classList.add("pop");

    const rankIds = isBot ? ["botRank","botRank2"] : ["youRank","youRank2"];
    const suitIds = isBot ? ["botSuit","botSuit2","botBig"] : ["youSuit","youSuit2","youBig"];

    $(rankIds[0]).textContent = cardObj.rank;
    $(rankIds[1]).textContent = cardObj.rank;
    $(suitIds[0]).textContent = cardObj.suit;
    $(suitIds[1]).textContent = cardObj.suit;
    $(suitIds[2]).textContent = cardObj.suit;

    const inner = card.querySelector(".cardInner");
    inner.classList.remove("red","blk");
    inner.classList.add(cardObj.color);
  }

  function animResult(winner){
    // winner: "you" | "bot" | "tie"
    const fast = chkFast.checked;
    const dur = fast ? 160 : 320;

    if (winner === "you"){
      youCard.classList.add("glowWin");
      botCard.classList.add("glowLose");
    } else if (winner === "bot"){
      botCard.classList.add("glowWin");
      youCard.classList.add("glowLose");
    } else {
      youCard.classList.add("shake");
      botCard.classList.add("shake");
    }
    setTimeout(()=>{
      youCard.classList.remove("glowWin","glowLose","shake");
      botCard.classList.remove("glowWin","glowLose","shake");
    }, dur);
  }

  // ----- Game state -----
  let you = [];
  let bot = [];
  let pot = [];          // cards in middle
  let inWar = false;     // slaf state
  let rounds = 0, wars = 0, youWins = 0, botWins = 0;

  let lastYou = null, lastBot = null;
  let busy = false;
  let auto = false;
  let autoTimer = null;

  function updateHUD(){
    botCount.textContent = bot.length;
    youCount.textContent = you.length;
    potCount.textContent = pot.length;
    warState.textContent = inWar ? "‡∏™‡∏•‡∏≤‡∏ü" : "‡∏õ‡∏Å‡∏ï‡∏¥";
    roundsEl.textContent = rounds;
    warsEl.textContent = wars;
    youWinsEl.textContent = youWins;
    botWinsEl.textContent = botWins;

    botVal.textContent = lastBot ? lastBot.value : "-";
    youVal.textContent = lastYou ? lastYou.value : "-";

    // mood
    if (auto) {
      botMood.textContent = "‡∏Å‡∏î‡∏î‡∏±‡∏ô";
      youMood.textContent = "‡πÇ‡∏´‡∏°‡∏î‡∏≠‡∏≠‡πÇ‡∏ï‡πâ";
    } else {
      botMood.textContent = inWar ? "‡πÄ‡∏≠‡∏≤‡∏à‡∏£‡∏¥‡∏á!" : "‡∏ô‡∏¥‡πà‡∏á‡πÜ";
      youMood.textContent = inWar ? "‡∏≠‡∏¢‡πà‡∏≤‡πÄ‡∏™‡∏°‡∏≠‡∏≠‡∏µ‡∏Å‡∏ô‡∏∞!" : "‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏•‡∏∏‡∏¢";
    }
  }

  function setButtons(){
    const started = (you.length + bot.length) > 0;
    btnDeal.disabled = false;
    btnFlip.disabled = !started || busy || isGameOver();
    btnAuto.disabled = !started || busy || isGameOver();
  }

  function isGameOver(){
    return (you.length === 0 || bot.length === 0) && (pot.length === 0 || !busy);
  }

  function endGame(){
    autoStop();
    const winner = you.length > bot.length ? "YOU" : "BOT";
    setStatus(`‡∏à‡∏ö‡πÄ‡∏Å‡∏° ‚Äî ‡∏ú‡∏π‡πâ‡∏ä‡∏ô‡∏∞: ${winner}`);
    addLog(`üèÅ ‡∏à‡∏ö‡πÄ‡∏Å‡∏°! ‡∏ú‡∏π‡πâ‡∏ä‡∏ô‡∏∞‡∏Ñ‡∏∑‡∏≠ <b>${winner}</b>`, winner === "YOU" ? "win" : "lose");
    showToast(`‡∏à‡∏ö‡πÄ‡∏Å‡∏°! ‡∏ä‡∏ô‡∏∞: ${winner}`);
    btnFlip.disabled = true;
    btnAuto.disabled = true;
  }

  function resetAll(){
    autoStop();
    you = []; bot = []; pot = [];
    inWar = false;
    rounds = 0; wars = 0; youWins = 0; botWins = 0;
    lastYou = null; lastBot = null;
    logEl.innerHTML = "";
    renderCard("you", null);
    renderCard("bot", null);
    setStatus("‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÄ‡∏£‡∏¥‡πà‡∏° (‡∏Å‡∏î‡πÅ‡∏à‡∏Å & ‡∏™‡∏±‡∏ö)");
    addLog("‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏Å‡∏°‡πÉ‡∏´‡∏°‡πà üé¥", "warn");
    updateHUD();
    setButtons();
  }

  function deal(){
    autoStop();
    const deck = shuffle(makeDeck());
    you = deck.slice(0, 26);
    bot = deck.slice(26);
    pot = [];
    inWar = false;
    rounds = 0; wars = 0; youWins = 0; botWins = 0;
    lastYou = null; lastBot = null;
    logEl.innerHTML = "";
    renderCard("you", null);
    renderCard("bot", null);
    setStatus("‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÅ‡∏•‡πâ‡∏ß! ‡∏Å‡∏î ‚Äú‡∏ß‡∏≤‡∏á‡πÑ‡∏û‡πà‚Äù");
    addLog("‡πÅ‡∏à‡∏Å‡πÑ‡∏û‡πà‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢ ‚úÖ YOU 26 ‡πÉ‡∏ö / BOT 26 ‡πÉ‡∏ö", "warn");
    updateHUD();
    setButtons();
    showToast("‡πÅ‡∏à‡∏Å‡πÑ‡∏û‡πà‡πÅ‡∏•‡πâ‡∏ß!");
  }

  function takeTop(arr){
    return arr.length ? arr.shift() : null;
  }

  function pushBottom(arr, cards){
    // randomize pot order slightly to avoid endless loops (helps war game)
    // but keep mostly fair
    if (cards.length > 2){
      // light shuffle: swap a few pairs
      for (let k=0; k<3; k++){
        const i = Math.floor(Math.random()*cards.length);
        const j = Math.floor(Math.random()*cards.length);
        [cards[i], cards[j]] = [cards[j], cards[i]];
      }
    }
    arr.push(...cards);
  }

  function autoStop(){
    auto = false;
    clearTimeout(autoTimer);
    autoTimer = null;
    btnAuto.textContent = "‡πÄ‡∏•‡πà‡∏ô‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥";
    updateHUD();
  }

  function autoStart(){
    if (auto) return;
    auto = true;
    btnAuto.textContent = "‡∏´‡∏¢‡∏∏‡∏î‡∏≠‡∏≠‡πÇ‡∏ï‡πâ";
    tickAuto();
    updateHUD();
  }

  function getAutoDelay(){
    const base = parseInt(rngSpeed.value, 10) || 520;
    return clamp(base, 150, 1200);
  }

  function tickAuto(){
    if (!auto) return;
    if (busy || isGameOver()){
      autoTimer = setTimeout(tickAuto, getAutoDelay());
      return;
    }
    flipOnce().then(()=>{
      autoTimer = setTimeout(tickAuto, getAutoDelay());
    });
  }

  async function flipOnce(){
    if (busy) return;
    if (you.length === 0 || bot.length === 0){
      if (isGameOver()) endGame();
      return;
    }

    busy = true;
    setButtons();

    const fast = chkFast.checked;
    const pause = fast ? 140 : 320;

    // draw
    const y = takeTop(you);
    const b = takeTop(bot);
    lastYou = y; lastBot = b;

    if (y) pot.push(y);
    if (b) pot.push(b);

    renderCard("you", y);
    renderCard("bot", b);
    updateHUD();

    rounds++;
    setStatus(inWar ? "‡∏™‡∏•‡∏≤‡∏ü‡∏≠‡∏¢‡∏π‡πà‚Ä¶ ‡πÄ‡∏õ‡∏¥‡∏î‡πÑ‡∏û‡πà‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô" : "‡πÄ‡∏õ‡∏¥‡∏î‡πÑ‡∏û‡πà‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡πÅ‡∏ï‡πâ‡∏°");
    addLog(`‡πÄ‡∏õ‡∏¥‡∏î‡πÑ‡∏û‡πà: YOU <b>${formatCard(y)}</b> (${y.value}) vs BOT <b>${formatCard(b)}</b> (${b.value})`);

    await sleep(pause);

    // compare
    if (y.value > b.value){
      animResult("you");
      youWins++;
      inWar = false;
      setStatus("YOU ‡∏ä‡∏ô‡∏∞‡∏£‡∏≠‡∏ö! ‡πÄ‡∏Å‡πá‡∏ö‡∏Å‡∏≠‡∏á‡∏Å‡∏•‡∏≤‡∏á");
      addLog(`‚úÖ YOU ‡∏ä‡∏ô‡∏∞‡∏£‡∏≠‡∏ö‡∏ô‡∏µ‡πâ ‚Äî ‡πÄ‡∏Å‡πá‡∏ö‡∏Å‡∏≠‡∏á‡∏Å‡∏•‡∏≤‡∏á <b>${pot.length}</b> ‡πÉ‡∏ö‡πÑ‡∏õ‡∏ó‡πâ‡∏≤‡∏¢‡∏Å‡∏≠‡∏á`, "win");
      const won = pot.splice(0, pot.length);
      pushBottom(you, won);
      await sleep(pause);
      renderCard("you", null);
      renderCard("bot", null);
    } else if (b.value > y.value){
      animResult("bot");
      botWins++;
      inWar = false;
      setStatus("BOT ‡∏ä‡∏ô‡∏∞‡∏£‡∏≠‡∏ö! ‡πÄ‡∏Å‡πá‡∏ö‡∏Å‡∏≠‡∏á‡∏Å‡∏•‡∏≤‡∏á");
      addLog(`‚ùå BOT ‡∏ä‡∏ô‡∏∞‡∏£‡∏≠‡∏ö‡∏ô‡∏µ‡πâ ‚Äî ‡πÄ‡∏Å‡πá‡∏ö‡∏Å‡∏≠‡∏á‡∏Å‡∏•‡∏≤‡∏á <b>${pot.length}</b> ‡πÉ‡∏ö‡πÑ‡∏õ‡∏ó‡πâ‡∏≤‡∏¢‡∏Å‡∏≠‡∏á`, "lose");
      const won = pot.splice(0, pot.length);
      pushBottom(bot, won);
      await sleep(pause);
      renderCard("you", null);
      renderCard("bot", null);
    } else {
      // tie -> WAR (slaf)
      animResult("tie");
      if (!inWar){
        wars++;
        addLog(`‚öîÔ∏è ‡πÄ‡∏™‡∏°‡∏≠! ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏•‡∏≤‡∏ü (‡∏Ñ‡∏ß‡πà‡∏≥ 3 ‡πÉ‡∏ö + ‡πÄ‡∏õ‡∏¥‡∏î 1 ‡πÉ‡∏ö)`, "warn");
      } else {
        addLog(`‚öîÔ∏è ‡∏¢‡∏±‡∏á‡πÄ‡∏™‡∏°‡∏≠‡∏≠‡∏µ‡∏Å! ‡∏™‡∏•‡∏≤‡∏ü‡∏ï‡πà‡∏≠‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‚Ä¶`, "warn");
      }
      inWar = true;
      setStatus("‡πÄ‡∏™‡∏°‡∏≠! ‡∏ß‡∏≤‡∏á‡πÑ‡∏û‡πà‡∏™‡∏•‡∏≤‡∏ü");
      await sleep(pause);

      // face-down 3 cards each if available
      const downCount = 3;
      const youDown = [];
      const botDown = [];

      for (let i=0; i<downCount; i++){
        const cy = takeTop(you);
        const cb = takeTop(bot);
        if (cy) { youDown.push(cy); pot.push(cy); }
        if (cb) { botDown.push(cb); pot.push(cb); }
        if (!cy && !cb) break;
      }

      if (youDown.length || botDown.length){
        addLog(`‡∏Ñ‡∏ß‡πà‡∏≥‡πÑ‡∏û‡πà‡∏™‡∏•‡∏≤‡∏ü: YOU ‡∏Ñ‡∏ß‡πà‡∏≥ <b>${youDown.length}</b> ‡πÉ‡∏ö, BOT ‡∏Ñ‡∏ß‡πà‡∏≥ <b>${botDown.length}</b> ‡πÉ‡∏ö (‡∏£‡∏ß‡∏°‡∏Å‡∏≠‡∏á‡∏Å‡∏•‡∏≤‡∏á ${pot.length} ‡πÉ‡∏ö)`, "warn");
      }

      // If someone ran out during war, handle
      if (you.length === 0 || bot.length === 0){
        // Need one more flip to decide? If someone has none, the other wins pot.
        if (you.length === 0 && bot.length === 0){
          // very rare
          addLog("‡∏ó‡∏±‡πâ‡∏á‡∏™‡∏≠‡∏á‡∏ù‡πà‡∏≤‡∏¢‡∏´‡∏°‡∏î‡πÑ‡∏û‡πà‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Å‡∏±‡∏ô üòµ ‡∏ñ‡∏∑‡∏≠‡∏ß‡πà‡∏≤‡πÄ‡∏™‡∏°‡∏≠!", "warn");
          setStatus("‡∏à‡∏ö‡πÄ‡∏Å‡∏° ‚Äî ‡πÄ‡∏™‡∏°‡∏≠");
          showToast("‡πÄ‡∏™‡∏°‡∏≠!");
        } else if (you.length === 0){
          botWins++;
          addLog(`YOU ‡πÑ‡∏û‡πà‡πÑ‡∏°‡πà‡∏û‡∏≠! BOT ‡πÄ‡∏Å‡πá‡∏ö‡∏Å‡∏≠‡∏á‡∏Å‡∏•‡∏≤‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î <b>${pot.length}</b> ‡πÉ‡∏ö`, "lose");
          const won = pot.splice(0, pot.length);
          pushBottom(bot, won);
        } else {
          youWins++;
          addLog(`BOT ‡πÑ‡∏û‡πà‡πÑ‡∏°‡πà‡∏û‡∏≠! YOU ‡πÄ‡∏Å‡πá‡∏ö‡∏Å‡∏≠‡∏á‡∏Å‡∏•‡∏≤‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î <b>${pot.length}</b> ‡πÉ‡∏ö`, "win");
          const won = pot.splice(0, pot.length);
          pushBottom(you, won);
        }
        inWar = false;
        await sleep(pause);
        renderCard("you", null);
        renderCard("bot", null);
      }
    }

    updateHUD();
    busy = false;
    setButtons();

    if (isGameOver()){
      endGame();
    } else if (!inWar){
      setStatus("‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏ß‡∏≤‡∏á‡πÑ‡∏û‡πà‡∏£‡∏≠‡∏ö‡∏ñ‡∏±‡∏î‡πÑ‡∏õ");
    } else {
      setStatus("‡∏™‡∏•‡∏≤‡∏ü‡∏≠‡∏¢‡∏π‡πà‚Ä¶ ‡∏Å‡∏î‡∏ß‡∏≤‡∏á‡πÑ‡∏û‡πà‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏¥‡∏î‡πÑ‡∏û‡πà‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô");
    }
  }

  // ----- Events -----
  btnNew.addEventListener("click", () => {
    resetAll();
    btnDeal.disabled = false;
    btnFlip.disabled = true;
    btnAuto.disabled = true;
  });

  btnDeal.addEventListener("click", () => {
    deal();
  });

  btnFlip.addEventListener("click", () => {
    flipOnce();
  });

  btnAuto.addEventListener("click", () => {
    if (!auto) autoStart();
    else autoStop();
    showToast(auto ? "‡∏≠‡∏≠‡πÇ‡∏ï‡πâ: ‡πÄ‡∏õ‡∏¥‡∏î" : "‡∏≠‡∏≠‡πÇ‡∏ï‡πâ: ‡∏õ‡∏¥‡∏î");
    updateHUD();
  });

  chkFast.addEventListener("change", () => {
    showToast(chkFast.checked ? "‡πÇ‡∏´‡∏°‡∏î‡πÄ‡∏£‡πá‡∏ß" : "‡πÇ‡∏´‡∏°‡∏î‡∏õ‡∏Å‡∏ï‡∏¥");
  });

  rngSpeed.addEventListener("input", () => {
    speedLabel.textContent = `${rngSpeed.value}ms`;
  });

  document.addEventListener("keydown", (e) => {
    if (e.code === "Space"){
      e.preventDefault();
      if (!btnFlip.disabled) btnFlip.click();
    }
    if (e.key.toLowerCase() === "a"){
      if (!btnAuto.disabled) btnAuto.click();
    }
    if (e.key.toLowerCase() === "r"){
      btnNew.click();
    }
  });

  // init
  speedLabel.textContent = `${rngSpeed.value}ms`;
  resetAll();
  btnDeal.disabled = false;
  setButtons();
  showToast("‡∏Å‡∏î '‡πÅ‡∏à‡∏Å & ‡∏™‡∏±‡∏ö' ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°!");
})();
</script>
</body>
</html>
